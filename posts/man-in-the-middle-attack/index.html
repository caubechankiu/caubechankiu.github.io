<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Man-in-the-Middle (MITM) Attack - caubechankiu's miscellaneous notes</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Tấn công MITM là một mối đe dọa đáng lo ngại khi sử dụng internet công cộng. Bài viết này sẽ giúp bạn hiểu rõ về MITM và cách phòng tránh nó."><meta property="og:image" content><meta property="og:url" content="https://caubechankiu.github.io/posts/man-in-the-middle-attack/"><meta property="og:site_name" content="caubechankiu's miscellaneous notes"><meta property="og:title" content="Man-in-the-Middle (MITM) Attack"><meta property="og:description" content="Tấn công MITM là một mối đe dọa đáng lo ngại khi sử dụng internet công cộng. Bài viết này sẽ giúp bạn hiểu rõ về MITM và cách phòng tránh nó."><meta property="og:locale" content="vi_VN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-05T00:00:00+00:00"><meta property="article:tag" content="Security"><meta name=twitter:card content="summary"><meta name=twitter:title content="Man-in-the-Middle (MITM) Attack"><meta name=twitter:description content="Tấn công MITM là một mối đe dọa đáng lo ngại khi sử dụng internet công cộng. Bài viết này sẽ giúp bạn hiểu rõ về MITM và cách phòng tránh nó."><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://caubechankiu.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://caubechankiu.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet type=text/css href=https://caubechankiu.github.io/css/archie.90f4a1321261c2df9485c29a7877582160bb95d018fefaa5f2199bccf7b169f5.css></head><body><div class=content><header><div class=main><a href=https://caubechankiu.github.io/>caubechankiu's miscellaneous notes</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/tags>Tags</a>
<a href=/search>Search</a>
| <span id=dark-mode-toggle onclick=toggleTheme()><svg class="feather"><use href="https://unpkg.com/feather-icons@4.29.2/dist/feather-sprite.svg#sun"/></svg></span>
<script src=https://caubechankiu.github.io/js/themetoggle.js></script></nav></header><main><article><div class=post-container><div class=post-content><div class=title><h1 class=title>Man-in-the-Middle (MITM) Attack</h1><div class=meta>Posted on Nov 5, 2024</div></div><section class=body><h1 id=man-in-the-middle-mitm-kẻ-nghe-trộm-vô-hình-đang-rình-rập-dữ-liệu-của-bạn>Man-in-the-Middle (MITM): Kẻ Nghe Trộm Vô Hình Đang Rình Rập Dữ Liệu Của Bạn</h1><p>Nếu bạn đã từng kết nối Wi-Fi ở quán cà phê, sân bay, hoặc bất kỳ mạng công cộng nào, bạn đã tự đặt mình vào tầm ngắm của một trong những mối đe dọa dai dẳng nhất trên internet: <strong>Tấn công Man-in-the-Middle (MITM)</strong>.</p><p>Hãy tưởng tượng bạn đang thì thầm một mật khẩu với ngân hàng của mình. Trong một cuộc tấn công MITM, một kẻ lạ mặt đang đứng chính giữa, nghe lén mọi thứ, và thậm chí còn có thể thay đổi tin nhắn của bạn trước khi nó đến đích. Mối đe dọa này không hề xa vời, và hiểu rõ về nó là bước đầu tiên để tự bảo vệ mình.</p><hr><h2 id=mitm-là-gì-và-nó-hoạt-động-như-thế-nào>MITM là gì và Nó Hoạt động như thế nào?</h2><p><strong>Man-in-the-Middle</strong> là một hình thức tấn công mạng mà kẻ xấu bí mật xen vào giữa hai bên đang giao tiếp, sau đó giả mạo cả hai bên để chặn, đánh cắp hoặc thay đổi dữ liệu được truyền đi. Cả hai nạn nhân đều tin rằng họ đang giao tiếp trực tiếp với nhau, trong khi thực tế họ đang &ldquo;nói chuyện&rdquo; với kẻ tấn công.</p><figure class=center><img src=/posts/man-in-the-middle-attack/man-in-middle-attack.png width=500px></figure><p>Cơ chế tấn công MITM diễn ra qua ba giai đoạn cơ bản:</p><h3 id=1-chặn-interception>1. Chặn (Interception)</h3><p>Bước đầu tiên là đưa kẻ tấn công vào giữa luồng giao tiếp. Kẻ tấn công sử dụng các kỹ thuật để đánh lừa mạng lưới hoặc thiết bị của bạn.</p><ul><li><strong>ARP Spoofing:</strong> Trong mạng cục bộ (như Wi-Fi gia đình, Wi-Fi công cộng), kẻ tấn công gửi các gói tin ARP giả mạo đến cả máy nạn nhân và router, thông báo rằng địa chỉ MAC của chúng là địa chỉ của router (với nạn nhân) và là địa chỉ của nạn nhân (với router). Lúc này, mọi gói tin mà nạn nhân gửi ra ngoài (bao gồm cả yêu cầu DNS) đều bị chuyển hướng đến máy của kẻ tấn công trước. Đồng thời tất cả các gói tin đến nạn nhân cũng phải đi qua máy của kẻ tấn công trước. Lúc này, máy của kẻ tấn công đã trở thành &ldquo;<em>người đàn ông ở giữa</em>&rdquo;.</li><li><strong>Evil Twin (Wi-Fi giả mạo):</strong> Kẻ tấn công tạo ra một điểm truy cập Wi-Fi giả mạo có tên tương tự như mạng công cộng (ví dụ: &ldquo;Free_Airport_WIFI&rdquo;). Bất kỳ ai kết nối vào mạng này đều bị kiểm soát.</li></ul><h3 id=2-giải-mã-và-đánh-cắp-decryption--impersonation>2. Giải mã và Đánh cắp (Decryption & Impersonation)</h3><p>Khi lưu lượng truy cập đã bị chặn, thách thức tiếp theo là đọc được nó, đặc biệt nếu nó được <strong>mã hóa</strong>.</p><ul><li><strong>SSL Stripping (Hạ cấp SSL):</strong> Kỹ thuật nguy hiểm này chặn yêu cầu kết nối HTTPS an toàn của bạn tới một trang web (ví dụ: ngân hàng). Thay vì để bạn kết nối an toàn, kẻ tấn công tự kết nối với trang web bằng HTTPS, rồi buộc bạn kết nối với chúng bằng HTTP (không an toàn). Bạn thấy icon https hình ổ khóa đã biến mất, nhưng có thể không kịp nhận ra.</li><li><strong>Giả mạo DNS (DNS Spoofing):</strong> Giao thức DNS thông thường hoạt động trên UDP và <strong>KHÔNG được mã hóa</strong>. Khi nạn nhân muốn truy cập <em><a href=https://www.bank.com>www.bank.com</a></em>, máy nạn nhân gửi yêu cầu phân giải tên miền (DNS Query) đến DNS Server (theo như nó nghĩ là Router, nhưng thực chất là máy của Kẻ tấn công). Ngay khi nhận được yêu cầu DNS từ Nạn nhân, kẻ tấn công sẽ tạo một gói tin Phản hồi DNS (DNS Response) giả mạo. Trong gói tin này, kẻ tấn công sẽ cung cấp địa chỉ IP của máy chủ giả mạo thay vì địa chỉ IP thực tế của <em><a href=https://www.bank.com>www.bank.com</a></em>. Máy nạn nhân chấp nhận phản hồi này là hợp lệ và lưu trữ bản ghi ánh xạ tên miền giả mạo vào bộ nhớ đệm DNS cục bộ (DNS Cache). Kết quả cuối cùng là khi nạn nhân cố gắng truy cập <em><a href=https://www.bank.com>www.bank.com</a></em>, trình duyệt sẽ dùng địa chỉ IP đã lưu trong cache và sẽ chuyển hướng đến một trang web lừa đảo hoàn toàn do chúng kiểm soát. Để thực sự ngăn chặn việc nghe lén và giả mạo ngay tại tầng DNS, cần sử dụng các giao thức mới giúp mã hóa truy vấn DNS đến máy chủ DNS công cộng (ví dụ: Cloudflare, Google DNS. Router lúc này không còn được xem là DNS Server nữa mà chỉ là một thiết bị chuyển tiếp):<ul><li><strong>DNS over HTTPS (DoH)</strong>: Mã hóa truy vấn DNS và phản hồi bên trong kết nối HTTPS (sử dụng cổng TCP 443).</li><li><strong>DNS over TLS (DoT)</strong>: Mã hóa truy vấn DNS và phản hồi bên trong kết nối TLS (sử dụng cổng TCP 853).</li></ul></li></ul><h3 id=3-truyền-tải-relaying>3. Truyền tải (Relaying)</h3><p>Sau khi đọc hoặc đánh cắp dữ liệu (mật khẩu, số thẻ), kẻ tấn công mã hóa lại dữ liệu nếu cần và gửi tiếp cho đích đến ban đầu. Toàn bộ quá trình này diễn ra trong tích tắc, khiến cuộc tấn công gần như vô hình đối với người dùng cuối.</p><hr><h2 id=hậu-quả-khủng-khiếp-của-mitm>Hậu Quả Khủng Khiếp của MITM</h2><p>Thiệt hại do MITM gây ra thường rất nghiêm trọng vì nó nhắm vào <strong>lớp tin cậy</strong> cơ bản trong giao tiếp mạng:</p><ul><li><strong>Đánh cắp Thông tin Đăng nhập:</strong> Đây là mục tiêu phổ biến nhất, bao gồm mật khẩu, tên người dùng, và mã PIN cho các dịch vụ tài chính.</li><li><strong>Thiệt hại Tài chính:</strong> Sử dụng thông tin thẻ tín dụng bị đánh cắp hoặc thay đổi thông tin giao dịch ngân hàng trực tuyến để chuyển tiền đến tài khoản của kẻ tấn công.</li><li><strong>Lộ Bí mật Doanh nghiệp:</strong> Nếu nhân viên bị tấn công khi đang làm việc từ xa, dữ liệu nhạy cảm của công ty, các tài liệu mật hoặc chiến lược kinh doanh có thể rơi vào tay kẻ xấu.</li><li><strong>Thay đổi Dữ liệu:</strong> Kẻ tấn công có thể thay đổi nội dung email, hợp đồng điện tử, hoặc hóa đơn, dẫn đến những tranh chấp pháp lý hoặc thiệt hại kinh tế lớn.</li></ul><hr><h2 id=các-biện-pháp-phòng-tránh-mitm-hiệu-quả>Các Biện pháp Phòng Tránh MITM Hiệu Quả</h2><p>Tin tốt là hầu hết các cuộc tấn công MITM có thể được ngăn chặn bằng các biện pháp bảo mật đơn giản nhưng hiệu quả.</p><h3 id=đối-với-cá-nhân-người-dùng>Đối với Cá nhân (Người dùng)</h3><ol><li><strong>Luôn Kiểm tra HTTPS:</strong><ul><li><strong>Quy tắc Vàng:</strong> Đừng bao giờ nhập thông tin nhạy cảm (mật khẩu, thẻ) trên một trang web không hiển thị <strong>biểu tượng ổ khóa</strong> và tiền tố <strong>$https://$</strong> trong thanh địa chỉ.</li><li>Hãy cẩn thận với những trang web ban đầu là HTTPS nhưng đột nhiên chuyển thành HTTP khi bạn bắt đầu nhập dữ liệu.</li></ul></li></ol><figure class=center><img src=/posts/man-in-the-middle-attack/detecting-man-in-middle-attack.png width=500px></figure><ol start=2><li><p><strong>Sử dụng VPN (Mạng riêng ảo) trên Wi-Fi Công cộng:</strong></p><ul><li><strong>VPN</strong> là tuyến phòng thủ tốt nhất. Nó mã hóa toàn bộ dữ liệu của bạn trước khi nó rời khỏi thiết bị, khiến bất kỳ kẻ tấn công nào chặn được dữ liệu cũng chỉ thấy một &ldquo;mớ bòng bong&rdquo; vô nghĩa.</li></ul></li><li><p><strong>Cẩn thận với Wi-Fi Mở:</strong></p><ul><li>Nếu bạn phải sử dụng Wi-Fi công cộng, hãy tránh xa các mạng yêu cầu ít hoặc không yêu cầu xác thực. Tuyệt đối <strong>không thực hiện giao dịch ngân hàng</strong> hay mua sắm trực tuyến.</li></ul></li><li><p><strong>Kích hoạt Xác thực Đa yếu tố (MFA/2FA):</strong></p><ul><li>Ngay cả khi mật khẩu của bạn bị đánh cắp, kẻ tấn công vẫn cần một mã dùng một lần (thường từ điện thoại của bạn) để đăng nhập, làm vô hiệu hóa dữ liệu bị đánh cắp.</li></ul></li></ol><h3 id=đối-với-doanh-nghiệp-quản-trị-viên-mạng>Đối với Doanh nghiệp (Quản trị viên mạng)</h3><ol><li><p><strong>Triển khai HSTS:</strong></p><ul><li><strong>HTTP Strict Transport Security (HSTS)</strong> buộc trình duyệt của người dùng chỉ kết nối với trang web bằng giao thức HTTPS, ngăn chặn hiệu quả các cuộc tấn công SSL Stripping.</li></ul></li><li><p><strong>Bảo vệ Cơ sở hạ tầng Mạng:</strong></p><ul><li>Sử dụng các giao thức bảo vệ ARP như <strong>Dynamic ARP Inspection (DAI)</strong> và <strong>DHCP Snooping</strong> để ngăn chặn các cuộc tấn công ARP Spoofing từ bên trong mạng.</li></ul></li><li><p><strong>Giám sát Mạng (IDS/IPS):</strong></p><ul><li>Sử dụng Hệ thống Phát hiện và Ngăn chặn Xâm nhập <strong>(IDS/IPS)</strong> để liên tục giám sát lưu lượng mạng và phát hiện các hoạt động đáng ngờ, bất thường (ví dụ: lưu lượng truy cập đột ngột định tuyến sai).</li></ul></li></ol><hr><h2 id=kết-luận>Kết luận</h2><p>Tấn công Man-in-the-Middle là một lời nhắc nhở rằng chúng ta không thể đơn thuần tin tưởng vào luồng dữ liệu của mình trên internet. Tuy nhiên, bằng cách tuân thủ các nguyên tắc bảo mật cơ bản như <strong>kiểm tra HTTPS</strong>, <strong>sử dụng VPN</strong>, và <strong>kích hoạt 2FA</strong>, bạn có thể giảm đáng kể rủi ro trở thành nạn nhân.</p><p>Hãy chủ động bảo vệ dữ liệu của mình. Bạn đã kiểm tra xem ứng dụng VPN của mình đã được bật chưa trước khi truy cập Wi-Fi công cộng lần tiếp theo?</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/security>Security</a></li></ul></nav></div></div></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/caubechankiu rel=me title=GitHub><svg class="feather"><use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github"/></svg></a><a class=border></a><a class=soc href=https://www.facebook.com/trinhthevils rel=me title=Facebook><svg class="feather"><use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#facebook"/></svg></a><a class=border></a></div><div class=footer-info>2025 © caubechankiu | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>