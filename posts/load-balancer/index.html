<!doctype html><html><head lang=en><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Load Balancer - caubechankiu's miscellaneous notes</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Trong tháº¿ giá»›i há»‡ thá»‘ng phÃ¢n tÃ¡n vÃ  á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i, Load Balancer (bá»™ cÃ¢n báº±ng táº£i) lÃ  má»™t trong nhá»¯ng thÃ nh pháº§n quan trá»ng nháº¥t. NÃ³ giÃºp há»‡ thá»‘ng Ä‘áº£m báº£o tÃ­nh kháº£ dá»¥ng cao (high availability), hiá»‡u suáº¥t tá»‘i Æ°u (performance) vÃ  kháº£ nÄƒng má»Ÿ rá»™ng (scalability)."><meta property="og:image" content><meta property="og:url" content="https://caubechankiu.github.io/posts/load-balancer/"><meta property="og:site_name" content="caubechankiu's miscellaneous notes"><meta property="og:title" content="Load Balancer"><meta property="og:description" content="Trong tháº¿ giá»›i há»‡ thá»‘ng phÃ¢n tÃ¡n vÃ  á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i, Load Balancer (bá»™ cÃ¢n báº±ng táº£i) lÃ  má»™t trong nhá»¯ng thÃ nh pháº§n quan trá»ng nháº¥t. NÃ³ giÃºp há»‡ thá»‘ng Ä‘áº£m báº£o tÃ­nh kháº£ dá»¥ng cao (high availability), hiá»‡u suáº¥t tá»‘i Æ°u (performance) vÃ  kháº£ nÄƒng má»Ÿ rá»™ng (scalability)."><meta property="og:locale" content="vi_VN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-04T09:47:31+07:00"><meta property="article:modified_time" content="2023-03-04T09:47:31+07:00"><meta property="article:tag" content="Load Balancer"><meta name=twitter:card content="summary"><meta name=twitter:title content="Load Balancer"><meta name=twitter:description content="Trong tháº¿ giá»›i há»‡ thá»‘ng phÃ¢n tÃ¡n vÃ  á»©ng dá»¥ng web hiá»‡n Ä‘áº¡i, Load Balancer (bá»™ cÃ¢n báº±ng táº£i) lÃ  má»™t trong nhá»¯ng thÃ nh pháº§n quan trá»ng nháº¥t. NÃ³ giÃºp há»‡ thá»‘ng Ä‘áº£m báº£o tÃ­nh kháº£ dá»¥ng cao (high availability), hiá»‡u suáº¥t tá»‘i Æ°u (performance) vÃ  kháº£ nÄƒng má»Ÿ rá»™ng (scalability)."><link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@1,500&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css2?family=Fira+Sans&display=swap" rel=stylesheet><link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://caubechankiu.github.io/css/main.6a0f23ea50fd34b46fee262a5a68e17d458c51a2bc99ba1ba018065de6b180c3.css><link id=darkModeStyle rel=stylesheet type=text/css href=https://caubechankiu.github.io/css/dark.50b57e12d401420df23965fed157368aba37b76df0ecefd0b1ecd4da664f01a0.css disabled><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><link rel=stylesheet type=text/css href=https://caubechankiu.github.io/css/archie.90f4a1321261c2df9485c29a7877582160bb95d018fefaa5f2199bccf7b169f5.css></head><body><div class=content><header><div class=main><a href=https://caubechankiu.github.io/>caubechankiu's miscellaneous notes</a></div><nav><a href=/>Home</a>
<a href=/posts>All posts</a>
<a href=/tags>Tags</a>
| <span id=dark-mode-toggle onclick=toggleTheme()><svg class="feather"><use href="https://unpkg.com/feather-icons@4.29.2/dist/feather-sprite.svg#sun"/></svg></span>
<script src=https://caubechankiu.github.io/js/themetoggle.js></script></nav></header><main><article><div class=post-container><div class=post-content><div class=title><h1 class=title>Load Balancer</h1><div class=meta>Posted on Mar 4, 2023</div></div><section class=body><h2 id=1-load-balancer-lÃ -gÃ¬>1. Load Balancer lÃ  gÃ¬?</h2><p>Load Balancer lÃ  má»™t thÃ nh pháº§n Ä‘á»©ng giá»¯a client vÃ  server, cÃ³ nhiá»‡m vá»¥ phÃ¢n phá»‘i cÃ¡c request tá»« client Ä‘áº¿n nhiá»u server backend.</p><p>VÃ­ dá»¥, khi báº¡n cÃ³ má»™t website cháº¡y trÃªn nhiá»u mÃ¡y chá»§ khÃ¡c nhau, load balancer sáº½ Ä‘iá»u phá»‘i yÃªu cáº§u cá»§a ngÆ°á»i dÃ¹ng sao cho:</p><ul><li>KhÃ´ng cÃ³ mÃ¡y chá»§ nÃ o bá»‹ quÃ¡ táº£i</li><li>Náº¿u má»™t mÃ¡y chá»§ há»ng, lÆ°u lÆ°á»£ng sáº½ Ä‘Æ°á»£c Ä‘iá»u hÆ°á»›ng sang mÃ¡y khÃ¡c</li><li>NgÆ°á»i dÃ¹ng váº«n tháº¥y há»‡ thá»‘ng hoáº¡t Ä‘á»™ng á»•n Ä‘á»‹nh, khÃ´ng bá»‹ giÃ¡n Ä‘oáº¡n</li></ul><p>Má»™t sá»‘ lÃ½ do chÃ­nh khiáº¿n load balancer trá»Ÿ thÃ nh &ldquo;must-have&rdquo; trong kiáº¿n trÃºc há»‡ thá»‘ng:</p><ul><li>ğŸš¦ <strong>TrÃ¡nh quÃ¡ táº£i</strong>: PhÃ¢n chia táº£i Ä‘á»u giá»¯a cÃ¡c server.</li><li>ğŸ’¡ <strong>TÄƒng hiá»‡u suáº¥t</strong>: GiÃºp pháº£n há»“i nhanh hÆ¡n báº±ng cÃ¡ch chá»n server Ã­t báº­n nháº¥t.</li><li>ğŸ”„ <strong>TÃ­nh sáºµn sÃ ng cao (HA)</strong>: Náº¿u má»™t server cháº¿t, lÆ°u lÆ°á»£ng sáº½ chuyá»ƒn sang server khÃ¡c.</li><li>ğŸ”’ <strong>Báº£o máº­t</strong>: áº¨n thÃ´ng tin server ná»™i bá»™, chá»‰ expose load balancer ra ngoÃ i.</li><li>ğŸ“ˆ <strong>Kháº£ nÄƒng má»Ÿ rá»™ng</strong>: ThÃªm hoáº·c bá»›t server backend mÃ  khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n ngÆ°á»i dÃ¹ng.</li></ul><h2 id=2-load-balancer-layer-4-vs-layer-7>2. Load Balancer Layer 4 vs Layer 7</h2><p>Load Balancer (LB) cÃ³ thá»ƒ hoáº¡t Ä‘á»™ng á»Ÿ nhiá»u táº§ng khÃ¡c nhau trong mÃ´ hÃ¬nh OSI, phá»• biáº¿n nháº¥t lÃ  <strong>Layer 4 (Transport Layer)</strong> vÃ  <strong>Layer 7 (Application Layer)</strong>. ChÃºng khÃ¡c nhau á»Ÿ má»©c Ä‘á»™ thÃ´ng tin mÃ  LB sá»­ dá»¥ng Ä‘á»ƒ Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh phÃ¢n phá»‘i request.</p><h3 id=21-layer-4-load-balancer-transport-layer>2.1. Layer 4 Load Balancer (Transport Layer)</h3><p>CÃ¡ch hoáº¡t Ä‘á»™ng:</p><ul><li>Dá»±a vÃ o thÃ´ng tin <strong>IP source/destination</strong> vÃ  <strong>TCP/UDP port</strong>.</li><li>LB khÃ´ng â€œÄ‘á»câ€ ná»™i dung gÃ³i tin á»Ÿ táº§ng á»©ng dá»¥ng (HTTP headers, body, query string, v.v.).</li><li>ThÆ°á»ng thá»±c hiá»‡n <strong>TCP/UDP connection forwarding</strong> (chuyá»ƒn tiáº¿p káº¿t ná»‘i).</li></ul><p>Æ¯u Ä‘iá»ƒm:</p><ul><li>Hiá»‡u nÄƒng cao, Ä‘á»™ trá»… tháº¥p do chá»‰ xá»­ lÃ½ metadata á»Ÿ transport layer.</li><li>ÄÆ¡n giáº£n, nháº¹.</li><li>ThÃ­ch há»£p cho cÃ¡c giao thá»©c khÃ´ng pháº£i HTTP (VD: SMTP, FTP, RTMP, gRPC qua HTTP/2).</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm:</p><ul><li>KhÃ´ng hiá»ƒu logic á»©ng dá»¥ng (khÃ´ng thá»ƒ route theo URL, header, cookie).</li><li>KhÃ³ triá»ƒn khai cÃ¡c chÃ­nh sÃ¡ch nÃ¢ng cao nhÆ° A/B testing, canary release.</li></ul><p>VÃ­ dá»¥: HAProxy (cháº¿ Ä‘á»™ TCP), Nginx Stream, AWS NLB.</p><h3 id=22-layer-7-load-balancer-application-layer>2.2. Layer 7 Load Balancer (Application Layer)</h3><p>CÃ¡ch hoáº¡t Ä‘á»™ng:</p><ul><li>Hiá»ƒu Ä‘Æ°á»£c giao thá»©c á»©ng dá»¥ng (HTTP, HTTPS, gRPC, WebSocket, v.v.).</li><li>CÃ³ thá»ƒ Ä‘á»c vÃ  phÃ¢n tÃ­ch <strong>header, cookie, query string, URL path</strong> Ä‘á»ƒ quyáº¿t Ä‘á»‹nh routing.</li></ul><p>Æ¯u Ä‘iá»ƒm:</p><ul><li>Cho phÃ©p routing linh hoáº¡t:<ul><li>/api/v1/* â†’ backend A</li><li>/static/* â†’ backend B</li></ul></li><li>Há»— trá»£ caching, compression, authentication, SSL termination.</li><li>Há»¯u Ã­ch cho microservices vÃ  kiáº¿n trÃºc hiá»‡n Ä‘áº¡i.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm:</p><ul><li>Náº·ng hÆ¡n, tá»‘n CPU vÃ  RAM do pháº£i xá»­ lÃ½ request á»Ÿ má»©c á»©ng dá»¥ng.</li><li>Äá»™ trá»… cÃ³ thá»ƒ cao hÆ¡n layer 4.</li></ul><p>VÃ­ dá»¥: Nginx (HTTP reverse proxy), HAProxy (HTTP mode), AWS ALB, Traefik, Envoy.</p><h2 id=3-thuáº­t-toÃ¡n-cÃ¢n-báº±ng-táº£i-load-balancing-algorithms>3. Thuáº­t ToÃ¡n CÃ¢n Báº±ng Táº£i (Load Balancing Algorithms)</h2><p><strong>Thuáº­t toÃ¡n cÃ¢n báº±ng táº£i</strong> lÃ  phÆ°Æ¡ng phÃ¡p mÃ  load balancer sá»­ dá»¥ng Ä‘á»ƒ phÃ¢n phá»‘i lÆ°u lÆ°á»£ng truy cáº­p vÃ  cÃ¡c yÃªu cáº§u Ä‘áº¿n nhiá»u mÃ¡y chá»§ hoáº·c tÃ i nguyÃªn khÃ¡c nhau.<br>Má»¥c tiÃªu chÃ­nh cá»§a nÃ³ lÃ  Ä‘áº£m báº£o sá»­ dá»¥ng hiá»‡u quáº£ tÃ i nguyÃªn, cáº£i thiá»‡n hiá»‡u nÄƒng há»‡ thá»‘ng, vÃ  duy trÃ¬ tÃ­nh sáºµn sÃ ng cao cÅ©ng nhÆ° Ä‘á»™ tin cáº­y.</p><p>Thuáº­t toÃ¡n cÃ¢n báº±ng táº£i giÃºp ngÄƒn cháº·n tÃ¬nh tráº¡ng má»™t mÃ¡y chá»§ bá»‹ quÃ¡ táº£i dáº«n Ä‘áº¿n giáº£m hiá»‡u nÄƒng hoáº·c há»ng hÃ³c.<br>Báº±ng cÃ¡ch phÃ¢n phá»‘i khá»‘i lÆ°á»£ng cÃ´ng viá»‡c, cÃ¡c thuáº­t toÃ¡n nÃ y tá»‘i Æ°u hÃ³a thá»i gian pháº£n há»“i, tá»‘i Ä‘a hÃ³a thÃ´ng lÆ°á»£ng vÃ  nÃ¢ng cao tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng.</p><p>CÃ¡c yáº¿u tá»‘ cÃ³ thá»ƒ Ä‘Æ°á»£c xem xÃ©t:</p><ul><li>NÄƒng lá»±c xá»­ lÃ½ cá»§a server</li><li>Sá»‘ káº¿t ná»‘i Ä‘ang hoáº¡t Ä‘á»™ng</li><li>Thá»i gian pháº£n há»“i</li><li>TÃ¬nh tráº¡ng sá»©c khá»e server</li></ul><p>DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c thuáº­t toÃ¡n cÃ¢n báº±ng táº£i ná»•i tiáº¿ng:</p><h3 id=31-round-robin>3.1. Round Robin</h3><p>PhÃ¢n phá»‘i yÃªu cáº§u Ä‘áº¿n cÃ¡c server theo vÃ²ng láº·p tuáº§n tá»±. Sau khi Ä‘áº¿n server cuá»‘i thÃ¬ quay láº¡i server Ä‘áº§u.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>PhÃ¢n phá»‘i Ä‘á»“ng Ä‘á»u, dá»… triá»ƒn khai, dá»… hiá»ƒu.</li><li>PhÃ¹ há»£p khi cÃ¡c server cÃ³ nÄƒng lá»±c giá»‘ng nhau.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>KhÃ´ng nháº­n biáº¿t táº£i thá»±c táº¿ cá»§a server.</li><li>KhÃ´ng cÃ³ &ldquo;session affinity&rdquo;.</li><li>Hiá»‡u nÄƒng kÃ©m náº¿u server khÃ¡c nhau vá» cáº¥u hÃ¬nh.</li><li>Máº«u phÃ¢n phá»‘i dá»… Ä‘oÃ¡n, cÃ³ thá»ƒ bá»‹ khai thÃ¡c.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>MÃ´i trÆ°á»ng Ä‘á»“ng nháº¥t.</li><li>á»¨ng dá»¥ng <strong>stateless</strong>.</li></ul><p><img src=round-robin.gif alt=round-robin></p><h3 id=32-least-connections>3.2. Least Connections</h3><p>PhÃ¢n phá»‘i yÃªu cáº§u Ä‘áº¿n server cÃ³ Ã­t káº¿t ná»‘i Ä‘ang hoáº¡t Ä‘á»™ng nháº¥t táº¡i thá»i Ä‘iá»ƒm Ä‘Ã³.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>Nháº­n biáº¿t táº£i theo sá»‘ káº¿t ná»‘i.</li><li>PhÃ¢n phá»‘i Ä‘á»™ng, thÃ­ch á»©ng vá»›i táº£i thay Ä‘á»•i.</li><li>Hiá»‡u quáº£ trong mÃ´i trÆ°á»ng khÃ´ng Ä‘á»“ng nháº¥t.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>Phá»©c táº¡p hÆ¡n Round Robin.</li><li>Cáº§n duy trÃ¬ tráº¡ng thÃ¡i káº¿t ná»‘i.</li><li>Dá»… xuáº¥t hiá»‡n &ldquo;spike&rdquo; khi káº¿t ná»‘i ngáº¯n háº¡n.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>MÃ´i trÆ°á»ng khÃ´ng Ä‘á»“ng nháº¥t.</li><li>á»¨ng dá»¥ng cÃ³ traffic biáº¿n Ä‘á»™ng.</li><li>á»¨ng dá»¥ng <strong>stateful</strong>.</li></ul><p><img src=least-connections.gif alt=least-connections></p><h3 id=33-weighted-round-robin-wrr>3.3. Weighted Round Robin (WRR)</h3><p>Cáº£i tiáº¿n cá»§a Round Robin, gÃ¡n trá»ng sá»‘ cho server dá»±a trÃªn nÄƒng lá»±c xá»­ lÃ½. Server máº¡nh hÆ¡n nháº­n nhiá»u yÃªu cáº§u hÆ¡n.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>PhÃ¢n phá»‘i theo nÄƒng lá»±c.</li><li>Linh hoáº¡t khi thay Ä‘á»•i hoáº·c thÃªm server.</li><li>NgÄƒn quÃ¡ táº£i server yáº¿u.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>KhÃ³ xÃ¡c Ä‘á»‹nh trá»ng sá»‘ chÃ­nh xÃ¡c.</li><li>TÄƒng overhead khi quáº£n lÃ½.</li><li>KhÃ´ng tá»‘i Æ°u trong táº£i biáº¿n Ä‘á»™ng máº¡nh.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>MÃ´i trÆ°á»ng khÃ´ng Ä‘á»“ng nháº¥t.</li><li>á»¨ng dá»¥ng web quy mÃ´ lá»›n.</li><li>Cá»¥m cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li></ul><p><img src=weighted-round-robin.gif alt=weighted-round-robin></p><h3 id=34-weighted-least-connections>3.4. Weighted Least Connections</h3><p>Káº¿t há»£p Least Connections vÃ  WRR. PhÃ¢n phá»‘i dá»±a trÃªn sá»‘ káº¿t ná»‘i Ä‘ang hoáº¡t Ä‘á»™ng <strong>vÃ </strong> trá»ng sá»‘ (nÄƒng lá»±c server).</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>CÃ¢n báº±ng Ä‘á»™ng vÃ  linh hoáº¡t.</li><li>Nháº­n biáº¿t nÄƒng lá»±c vÃ  táº£i hiá»‡n táº¡i.</li><li>Tá»‘i Æ°u trong mÃ´i trÆ°á»ng phá»©c táº¡p.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>KhÃ³ triá»ƒn khai hÆ¡n.</li><li>Cáº§n duy trÃ¬ tráº¡ng thÃ¡i káº¿t ná»‘i + trá»ng sá»‘.</li><li>Trá»ng sá»‘ khÃ³ xÃ¡c Ä‘á»‹nh.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>Server khÃ´ng Ä‘á»“ng nháº¥t.</li><li>á»¨ng dá»¥ng web táº£i cao.</li><li>Cá»¥m cÆ¡ sá»Ÿ dá»¯ liá»‡u.</li></ul><p><img src=weighted-least-connections.gif alt=weighted-least-connections></p><h3 id=35-ip-hash>3.5. IP Hash</h3><p>Sá»­ dá»¥ng Ä‘á»‹a chá»‰ IP cá»§a client Ä‘á»ƒ tÃ­nh toÃ¡n báº±ng hÃ m bÄƒm, sau Ä‘Ã³ Ä‘á»‹nh tuyáº¿n Ä‘áº¿n server tÆ°Æ¡ng á»©ng.<br>GiÃºp cÃ¡c yÃªu cáº§u tá»« má»™t IP nháº¥t Ä‘á»‹nh luÃ´n Ä‘i Ä‘áº¿n cÃ¹ng má»™t server.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>Duy trÃ¬ phiÃªn (session persistence).</li><li>Dá»… triá»ƒn khai.</li><li>Tuyáº¿n cá»‘ Ä‘á»‹nh vÃ  dá»± Ä‘oÃ¡n Ä‘Æ°á»£c.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>PhÃ¢n phá»‘i khÃ´ng Ä‘á»u náº¿u IP phÃ¢n bá»‘ lá»‡ch.</li><li>ThÃªm/bá»›t server lÃ m thay Ä‘á»•i mapping.</li><li>KhÃ´ng xÃ©t Ä‘áº¿n táº£i thá»±c táº¿.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>á»¨ng dá»¥ng <strong>stateful</strong> (giá» hÃ ng, session ngÆ°á»i dÃ¹ng).</li><li>NgÆ°á»i dÃ¹ng phÃ¢n bá»‘ theo khu vá»±c Ä‘á»‹a lÃ½.</li></ul><p><img src=ip-hash.gif alt=ip-hash></p><h3 id=36-least-response-time>3.6. Least Response Time</h3><p>PhÃ¢n phá»‘i Ä‘áº¿n server cÃ³ <strong>thá»i gian pháº£n há»“i tháº¥p nháº¥t</strong>.</p><p>CÃ¡ch hoáº¡t Ä‘á»™ng</p><ol><li>Load balancer theo dÃµi thá»i gian pháº£n há»“i cá»§a tá»«ng server.</li><li>Khi cÃ³ request, chá»n server cÃ³ thá»i gian pháº£n há»“i trung bÃ¬nh tháº¥p nháº¥t.</li><li>Äiá»u chá»‰nh liÃªn tá»¥c dá»±a trÃªn dá»¯ liá»‡u thá»i gian thá»±c.</li></ol><p>Æ¯u Ä‘iá»ƒm</p><ul><li>Hiá»‡u nÄƒng tá»‘i Æ°u, giáº£m Ä‘á»™ trá»….</li><li>Linh hoáº¡t vá»›i táº£i thay Ä‘á»•i.</li><li>Táº­n dá»¥ng tÃ i nguyÃªn tá»‘t hÆ¡n.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>Phá»©c táº¡p hÆ¡n.</li><li>Overhead khi giÃ¡m sÃ¡t liÃªn tá»¥c.</li><li>Biáº¿n Ä‘á»™ng ngáº¯n háº¡n cÃ³ thá»ƒ gÃ¢y rebalancing liÃªn tá»¥c.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>á»¨ng dá»¥ng thá»i gian thá»±c (game, video streaming, trading).</li><li>API yÃªu cáº§u pháº£n há»“i nhanh.</li></ul><p><img src=least-response-time.gif alt=least-response-time></p><h3 id=37-random>3.7. Random</h3><p>Chá»n ngáº«u nhiÃªn má»™t server Ä‘á»ƒ xá»­ lÃ½ má»—i request.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>Cá»±c ká»³ Ä‘Æ¡n giáº£n.</li><li>KhÃ´ng cáº§n lÆ°u tráº¡ng thÃ¡i.</li><li>Náº¿u ngáº«u nhiÃªn Ä‘á»u thÃ¬ lÃ¢u dÃ i sáº½ cÃ¢n báº±ng.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>KhÃ´ng nháº­n biáº¿t táº£i.</li><li>Ngáº¯n háº¡n cÃ³ thá»ƒ máº¥t cÃ¢n báº±ng.</li><li>KhÃ´ng há»— trá»£ session affinity.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>Server Ä‘á»“ng nháº¥t.</li><li>á»¨ng dá»¥ng <strong>stateless</strong>.</li><li>Triá»ƒn khai nhá», Ä‘Æ¡n giáº£n.</li></ul><p><img src=random.gif alt=random></p><h3 id=38-least-bandwidth>3.8. Least Bandwidth</h3><p>Chá»n server Ä‘ang tiÃªu thá»¥ <strong>Ã­t bÄƒng thÃ´ng nháº¥t</strong>.</p><p>Æ¯u Ä‘iá»ƒm</p><ul><li>CÃ¢n báº±ng Ä‘á»™ng theo bÄƒng thÃ´ng.</li><li>NgÄƒn server bá»‹ quÃ¡ táº£i traffic.</li><li>Táº­n dá»¥ng tÃ i nguyÃªn máº¡ng hiá»‡u quáº£.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>Phá»©c táº¡p, cáº§n giÃ¡m sÃ¡t bÄƒng thÃ´ng liÃªn tá»¥c.</li><li>Tá»‘n overhead.</li><li>BÄƒng thÃ´ng biáº¿n Ä‘á»™ng ngáº¯n háº¡n gÃ¢y máº¥t á»•n Ä‘á»‹nh.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>á»¨ng dá»¥ng dÃ¹ng nhiá»u bÄƒng thÃ´ng (streaming, download).</li><li>CDN.</li><li>á»¨ng dá»¥ng thá»i gian thá»±c.</li></ul><p><img src=least-bandwidth.gif alt=least-bandwidth></p><h3 id=39-custom-load>3.9. Custom Load</h3><p>Cho phÃ©p Ä‘á»‹nh nghÄ©a <strong>metrics tÃ¹y chá»‰nh</strong> (CPU, RAM, Disk I/O, metric riÃªng cá»§a á»©ng dá»¥ng) Ä‘á»ƒ quyáº¿t Ä‘á»‹nh phÃ¢n phá»‘i táº£i.</p><p>CÃ¡ch hoáº¡t Ä‘á»™ng</p><ol><li>Äá»‹nh nghÄ©a metric phÃ¹ há»£p.</li><li>Theo dÃµi metric trÃªn tá»«ng server.</li><li>Äáº·t quy táº¯c cÃ¢n báº±ng táº£i dá»±a trÃªn metric.</li><li>PhÃ¢n phá»‘i Ä‘á»™ng dá»±a theo dá»¯ liá»‡u thá»±c táº¿.</li></ol><p>Æ¯u Ä‘iá»ƒm</p><ul><li>Ráº¥t linh hoáº¡t.</li><li>Tá»‘i Æ°u tÃ i nguyÃªn theo nhu cáº§u á»©ng dá»¥ng.</li><li>Dá»… thÃ­ch á»©ng vá»›i mÃ´i trÆ°á»ng Ä‘á»™ng.</li></ul><p>NhÆ°á»£c Ä‘iá»ƒm</p><ul><li>KhÃ³ triá»ƒn khai, cáº¥u hÃ¬nh phá»©c táº¡p.</li><li>Overhead do giÃ¡m sÃ¡t nhiá»u metric.</li><li>Dá»… sai náº¿u Ä‘á»‹nh nghÄ©a metric khÃ´ng há»£p lÃ½.</li></ul><p>TrÆ°á»ng há»£p sá»­ dá»¥ng</p><ul><li>á»¨ng dá»¥ng phá»©c táº¡p.</li><li>MÃ´i trÆ°á»ng Ä‘á»™ng, táº£i thay Ä‘á»•i nhanh.</li><li>YÃªu cáº§u Ä‘áº·c thÃ¹ mÃ  thuáº­t toÃ¡n chuáº©n khÃ´ng Ä‘Ã¡p á»©ng.</li></ul><h3 id=4-horizontal-scaling-má»Ÿ-rá»™ng-theo-chiá»u-ngang>4. Horizontal Scaling (Má»Ÿ rá»™ng theo chiá»u ngang)</h3><p><strong>Load balancer</strong> há»— trá»£ má»Ÿ rá»™ng theo chiá»u ngang, giÃºp cáº£i thiá»‡n hiá»‡u nÄƒng vÃ  kháº£ nÄƒng sáºµn sÃ ng cá»§a há»‡ thá»‘ng.</p><p>Thay vÃ¬ tÄƒng sá»©c máº¡nh cho má»™t server duy nháº¥t báº±ng pháº§n cá»©ng Ä‘áº¯t tiá»n (<strong>Vertical Scaling</strong>), má»Ÿ rá»™ng theo chiá»u ngang sá»­ dá»¥ng nhiá»u mÃ¡y chá»§ phá»• thÃ´ng (commodity machines) Ä‘á»ƒ chia táº£i.<br>Äiá»u nÃ y mang láº¡i hiá»‡u quáº£ chi phÃ­ tá»‘t hÆ¡n vÃ  Ä‘á»™ sáºµn sÃ ng cao hÆ¡n.</p><p>NhÆ°á»£c Ä‘iá»ƒm cá»§a Horizontal Scaling</p><ul><li><strong>TÄƒng Ä‘á»™ phá»©c táº¡p</strong>: Viá»‡c nhÃ¢n báº£n nhiá»u server lÃ m há»‡ thá»‘ng khÃ³ quáº£n lÃ½ hÆ¡n.</li><li><strong>YÃªu cáº§u server stateless</strong>: CÃ¡c server khÃ´ng nÃªn lÆ°u dá»¯ liá»‡u liÃªn quan Ä‘áº¿n ngÆ°á»i dÃ¹ng (vÃ­ dá»¥: session, áº£nh Ä‘áº¡i diá»‡n).</li><li><strong>Quáº£n lÃ½ session</strong>: Cáº§n lÆ°u session táº¡i má»™t kho táº­p trung nhÆ°:<ul><li>CÆ¡ sá»Ÿ dá»¯ liá»‡u (<strong>SQL, NoSQL</strong>)</li><li>Bá»™ nhá»› cache bá»n vá»¯ng (<strong>Redis, Memcached</strong>)</li></ul></li><li><strong>Ãp lá»±c lÃªn downstream servers</strong>: Khi má»Ÿ rá»™ng upstream servers, cÃ¡c há»‡ thá»‘ng phÃ­a sau nhÆ° cache hoáº·c database pháº£i xá»­ lÃ½ nhiá»u káº¿t ná»‘i Ä‘á»“ng thá»i hÆ¡n.</li><li>Load balancer cÃ³ thá»ƒ trá»Ÿ thÃ nh <strong>Ä‘iá»ƒm ngháº½n hiá»‡u nÄƒng</strong> náº¿u khÃ´ng Ä‘á»§ tÃ i nguyÃªn hoáº·c cáº¥u hÃ¬nh sai. Náº¿u chá»‰ cÃ³ <strong>má»™t load balancer</strong>, chÃ­nh nÃ³ trá»Ÿ thÃ nh <strong>single point of failure</strong>. Äá»ƒ kháº¯c phá»¥c, cáº§n cáº¥u hÃ¬nh <strong>nhiá»u load balancer</strong>, nhÆ°ng Ä‘iá»u nÃ y láº¡i lÃ m phá»©c táº¡p hÆ¡n ná»¯a.</li></ul></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/load-balancer>load balancer</a></li></ul></nav></div></div></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/caubechankiu rel=me title=GitHub><svg class="feather"><use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#github"/></svg></a><a class=border></a><a class=soc href=https://www.facebook.com/trinhthevils rel=me title=Facebook><svg class="feather"><use href="/svg/feather-sprite.51cf5647cb1987f769b616558f2620fd9423d72058490231b391bf6aa3744b55.svg#facebook"/></svg></a><a class=border></a></div><div class=footer-info>2025 Â© caubechankiu | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer></div></body></html>